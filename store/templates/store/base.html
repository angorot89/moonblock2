{% load static moonblock_tags %}
<!DOCTYPE html>
<html lang="{{ lang }}" {% if is_rtl %}dir="rtl"{% endif %}>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>{% block title %}MOONBLOCK{% endblock %}</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=DM+Mono:wght@300;400;500&family=Syne:wght@400;700;800&display=swap" rel="stylesheet">
<style>
:root {
  --black: #060608;
  --white: #F2F0EC;
  --moon: #C8B99A;
  --accent: #E8D5B0;
  --dim: #1A1A20;
  --muted: #6B6870;
}
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{background:var(--black);color:var(--white);font-family:'DM Mono',monospace;cursor:none;overflow-x:hidden;}
{% if is_rtl %}body{font-family:'DM Mono',monospace,Arial;}{% endif %}
img{max-width:100%;height:auto;}

/* Custom Cursor */
.cursor{width:12px;height:12px;background:var(--moon);border-radius:50%;position:fixed;top:0;left:0;pointer-events:none;z-index:9999;transform:translate(-50%,-50%);transition:transform 0.1s,width 0.3s,height 0.3s,background 0.3s;}
.cursor-ring{width:36px;height:36px;border:1px solid var(--moon);border-radius:50%;position:fixed;top:0;left:0;pointer-events:none;z-index:9998;transform:translate(-50%,-50%);transition:all 0.15s ease;opacity:0.5;}
body:hover .cursor{opacity:1;}

/* Nav */
nav{position:fixed;top:0;left:0;right:0;z-index:100;padding:24px 48px;display:flex;align-items:center;justify-content:space-between;}
nav::before{content:'';position:absolute;inset:0;background:linear-gradient(to bottom,rgba(6,6,8,0.9),transparent);pointer-events:none;}
.logo{font-family:'Bebas Neue',sans-serif;font-size:28px;letter-spacing:0.15em;color:var(--white);text-decoration:none;position:relative;z-index:1;}
.logo span{color:var(--moon);}
.nav-links{display:flex;gap:40px;list-style:none;position:relative;z-index:1;}
.nav-links li{position:relative;}
.nav-links a{color:var(--white);text-decoration:none;font-size:11px;letter-spacing:0.2em;text-transform:uppercase;opacity:0.7;transition:opacity 0.3s;}
.nav-links a:hover,.nav-links a.active{opacity:1;color:var(--moon);}
.nav-dropdown{position:absolute;top:calc(100% + 10px);left:0;min-width:230px;background:rgba(8,8,12,.96);border:1px solid rgba(200,185,154,.22);padding:10px;display:flex;flex-direction:column;gap:4px;opacity:0;visibility:hidden;transform:translateY(8px);transition:opacity .22s ease,transform .22s ease,visibility .22s ease;}
.nav-dropdown a{display:block;padding:9px 10px;font-size:10px;letter-spacing:.13em;border:1px solid transparent;}
.nav-dropdown a:hover,.nav-dropdown a.active{border-color:rgba(200,185,154,.25);background:rgba(200,185,154,.08);}
.nav-links li:hover .nav-dropdown{opacity:1;visibility:visible;transform:translateY(0);}
.nav-right{display:flex;align-items:center;gap:16px;position:relative;z-index:1;}
.nav-cta{background:var(--moon);color:var(--black);padding:10px 24px;font-family:'DM Mono',monospace;font-size:11px;letter-spacing:0.15em;text-transform:uppercase;text-decoration:none;transition:background 0.3s;}
.nav-cta:hover{background:var(--accent);}
.cart-link{color:var(--white);text-decoration:none;font-size:11px;letter-spacing:.15em;text-transform:uppercase;display:flex;align-items:center;gap:8px;opacity:.8;transition:opacity .3s;}
.cart-link:hover{opacity:1;color:var(--moon);}
.cart-badge{background:var(--moon);color:var(--black);font-size:9px;font-weight:bold;width:18px;height:18px;border-radius:50%;display:flex;align-items:center;justify-content:center;}
.auth-link{color:var(--white);text-decoration:none;font-size:10px;letter-spacing:.14em;text-transform:uppercase;opacity:.8;transition:opacity .2s,color .2s;}
.auth-link:hover{opacity:1;color:var(--moon);}
.user-greeting{font-size:10px;letter-spacing:.12em;text-transform:uppercase;color:var(--moon);}

/* Language Switcher */
.lang-switcher{display:flex;gap:4px;position:relative;z-index:1;}
.lang-btn{background:transparent;border:1px solid rgba(200,185,154,0.25);color:var(--muted);font-family:'DM Mono',monospace;font-size:10px;letter-spacing:0.1em;padding:5px 10px;cursor:none;transition:all 0.2s;text-decoration:none;text-transform:uppercase;}
.lang-btn:hover,.lang-btn.active{border-color:var(--moon);color:var(--moon);}

/* Ticker */
.ticker{background:var(--moon);padding:14px 0;overflow:hidden;white-space:nowrap;}
.ticker-inner{display:inline-flex;animation:ticker 20s linear infinite;gap:0;}
.ticker-item{font-family:'Bebas Neue',sans-serif;font-size:18px;letter-spacing:0.1em;color:var(--black);padding:0 32px;}
.ticker-dot{color:var(--black);opacity:0.4;font-size:18px;line-height:1.2;}
@keyframes ticker{from{transform:translateX(0);}to{transform:translateX(-50%);}}

/* Buttons */
.btn-primary{background:var(--moon);color:var(--black);padding:16px 40px;font-family:'DM Mono',monospace;font-size:12px;letter-spacing:0.2em;text-transform:uppercase;text-decoration:none;transition:background 0.3s,transform 0.2s;display:inline-block;border:none;cursor:none;}
.btn-primary:hover{background:var(--accent);transform:translateY(-2px);}
.btn-outline{border:1px solid rgba(200,185,154,.4);color:var(--white);padding:14px 36px;font-family:'DM Mono',monospace;font-size:12px;letter-spacing:.2em;text-transform:uppercase;text-decoration:none;cursor:none;transition:border-color .3s,color .3s;display:inline-block;background:transparent;}
.btn-outline:hover{border-color:var(--moon);color:var(--moon);}
.btn-ghost{color:var(--white);font-size:12px;letter-spacing:0.15em;text-transform:uppercase;text-decoration:none;opacity:0.6;transition:opacity 0.3s;display:flex;align-items:center;gap:8px;}
.btn-ghost:hover{opacity:1;}
.btn-ghost::after{content:'‚Üí';}
{% if is_rtl %}.btn-ghost::after{content:'‚Üê';}{% endif %}

/* Section labels */
.section-label{font-size:11px;letter-spacing:0.3em;text-transform:uppercase;color:var(--moon);margin-bottom:12px;}
.section-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(40px,6vw,72px);letter-spacing:0.03em;line-height:1;}

/* Messages */
.messages-container{position:fixed;top:80px;right:24px;z-index:200;display:flex;flex-direction:column;gap:10px;}
.message{background:var(--dim);border-left:3px solid var(--moon);padding:14px 20px;font-size:12px;letter-spacing:.05em;max-width:300px;animation:slideIn .3s ease;}
@keyframes slideIn{from{opacity:0;transform:translateX(20px);}to{opacity:1;transform:translateX(0);}}

/* Reveal */
.reveal{opacity:0;transform:translateY(40px);transition:opacity 0.8s ease,transform 0.8s ease;}
.reveal.visible{opacity:1;transform:translateY(0);}

/* Summer notice */
.summer-notice{position:fixed;inset:0;z-index:450;display:none;align-items:center;justify-content:center;padding:20px;background:rgba(3,4,8,.72);backdrop-filter:blur(6px);}
.summer-notice.show{display:flex;}
.summer-card{position:relative;width:min(620px,100%);background:linear-gradient(160deg,#11131c 0%,#0a0c12 65%,#181112 100%);border:1px solid rgba(200,185,154,.32);padding:28px 24px;box-shadow:0 26px 60px rgba(0,0,0,.55);animation:noticeIn .45s ease both;}
.summer-badge{display:inline-flex;align-items:center;gap:8px;font-size:10px;letter-spacing:.18em;text-transform:uppercase;color:var(--moon);margin-bottom:14px;}
.summer-title{font-family:'Bebas Neue',sans-serif;font-size:clamp(34px,6vw,58px);line-height:.96;letter-spacing:.03em;margin-bottom:12px;}
.summer-copy{font-size:13px;line-height:1.9;letter-spacing:.03em;color:var(--muted);margin-bottom:20px;max-width:560px;}
.summer-actions{display:flex;flex-wrap:wrap;gap:10px;}
.summer-btn{padding:12px 16px;font-size:11px;letter-spacing:.16em;text-transform:uppercase;text-decoration:none;border:1px solid rgba(200,185,154,.3);color:var(--white);}
.summer-btn.primary{background:var(--moon);color:var(--black);border-color:var(--moon);}
.summer-skip{position:absolute;top:12px;right:12px;background:transparent;border:1px solid rgba(200,185,154,.25);color:var(--muted);font-size:10px;letter-spacing:.12em;text-transform:uppercase;padding:7px 10px;cursor:none;}
@keyframes noticeIn{from{opacity:0;transform:translateY(18px) scale(.98);}to{opacity:1;transform:translateY(0) scale(1);}}

/* Footer */
footer{background:#030304;padding:80px 48px 40px;}
.footer-top{display:grid;grid-template-columns:2fr 1fr 1fr 1fr;gap:60px;padding-bottom:60px;border-bottom:1px solid rgba(200,185,154,0.08);}
.footer-brand .logo{display:block;margin-bottom:20px;}
.footer-tagline{font-size:12px;color:var(--muted);line-height:1.8;max-width:260px;letter-spacing:0.05em;}
.footer-col h4{font-size:10px;letter-spacing:0.3em;text-transform:uppercase;color:var(--moon);margin-bottom:24px;}
.footer-col ul{list-style:none;}
.footer-col li{margin-bottom:12px;}
.footer-col a{color:var(--muted);text-decoration:none;font-size:12px;letter-spacing:0.05em;transition:color .3s;}
.footer-col a:hover{color:var(--white);}
.footer-bottom{margin-top:40px;display:flex;align-items:center;justify-content:space-between;}
.footer-copy{font-size:11px;color:var(--muted);letter-spacing:0.1em;opacity:0.5;}
.socials{display:flex;gap:24px;}
.social-link{color:var(--muted);text-decoration:none;font-size:11px;letter-spacing:0.15em;text-transform:uppercase;transition:color .3s;}
.social-link:hover{color:var(--moon);}
.social-icon{width:16px;height:16px;display:block;}
.ai-fab{position:fixed;right:24px;bottom:24px;z-index:220;width:68px;height:68px;border-radius:50%;display:flex;align-items:center;justify-content:center;text-decoration:none;transition:transform .22s ease,filter .22s ease;filter:drop-shadow(0 10px 24px rgba(0,0,0,.5));}
.ai-fab:hover{transform:translateY(-3px) scale(1.04);filter:drop-shadow(0 16px 30px rgba(0,0,0,.62));}
.ai-core{position:relative;width:68px;height:68px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:radial-gradient(circle at 30% 22%,#fff4d9 0%,#d6c7aa 36%,#8e7d59 68%,#433927 100%);border:1px solid rgba(255,239,195,.5);}
.ai-face{position:relative;z-index:2;width:34px;height:34px;border-radius:10px;background:linear-gradient(180deg,#1d1f27 0%,#11131a 100%);border:1px solid rgba(200,185,154,.45);display:flex;align-items:center;justify-content:center;}
.ai-eye{position:absolute;top:11px;width:6px;height:6px;border-radius:50%;background:#e7d5b1;box-shadow:0 0 6px rgba(231,213,177,.85);}
.ai-eye.left{left:9px;}
.ai-eye.right{right:9px;}
.ai-mouth{position:absolute;bottom:8px;left:50%;transform:translateX(-50%);width:14px;height:2px;background:rgba(231,213,177,.9);border-radius:2px;}
.ai-hand{position:absolute;right:8px;top:8px;width:11px;height:11px;border-radius:50% 50% 44% 44%;background:#1d1f27;border:1px solid rgba(200,185,154,.45);transform-origin:2px 9px;animation:aiWave 1.25s ease-in-out infinite;}
.ai-core::before{content:'';position:absolute;inset:6px;border-radius:50%;border:1px solid rgba(6,6,8,.24);}
.ai-core::after{content:'';position:absolute;top:15px;right:14px;width:7px;height:7px;border-radius:50%;background:#fff7e0;box-shadow:0 0 10px rgba(255,255,255,.8);}
.ai-orbit{position:absolute;inset:-6px;border-radius:50%;border:1px dashed rgba(200,185,154,.45);animation:orbitSpin 6.5s linear infinite;}
.ai-dot{position:absolute;top:-3px;left:50%;transform:translateX(-50%);width:6px;height:6px;border-radius:50%;background:var(--moon);box-shadow:0 0 10px rgba(200,185,154,.75);}
.ai-bubble{position:fixed;right:102px;bottom:42px;z-index:220;max-width:250px;padding:10px 12px;background:rgba(8,8,12,.95);border:1px solid rgba(200,185,154,.28);color:var(--white);font-size:11px;letter-spacing:.08em;line-height:1.5;opacity:0;transform:translateY(8px);pointer-events:none;transition:opacity .22s ease,transform .22s ease;}
.ai-bubble.show{opacity:1;transform:translateY(0);}
.ai-bubble::after{content:'';position:absolute;right:-6px;bottom:16px;width:10px;height:10px;background:rgba(8,8,12,.95);border-right:1px solid rgba(200,185,154,.28);border-bottom:1px solid rgba(200,185,154,.28);transform:rotate(-45deg);}
.ai-fab.idle .ai-core{animation:botNudge .8s ease 2;}
@keyframes botNudge{0%,100%{transform:translateY(0);}25%{transform:translateY(-2px);}75%{transform:translateY(2px);}}
@keyframes aiWave{0%,100%{transform:rotate(12deg);}50%{transform:rotate(38deg);}}
@keyframes orbitSpin{to{transform:rotate(360deg);}}

/* RTL adjustments */
{% if is_rtl %}
.footer-top{direction:rtl;}
.nav-links{flex-direction:row-reverse;}
.nav-dropdown{left:auto;right:0;}
.footer-bottom{flex-direction:row-reverse;}
.messages-container{right:auto;left:24px;}
.message{border-left:none;border-right:3px solid var(--moon);}
.ai-fab{right:auto;left:24px;}
.ai-bubble{right:auto;left:102px;}
.ai-bubble::after{right:auto;left:-6px;border-right:none;border-bottom:none;border-left:1px solid rgba(200,185,154,.28);border-top:1px solid rgba(200,185,154,.28);transform:rotate(-45deg);}
{% endif %}

@media(max-width:900px){
  nav{padding:16px 16px 12px;flex-wrap:wrap;gap:10px;}
  .nav-links{display:none;}
  .logo{font-size:24px;}
  .nav-right{width:100%;justify-content:flex-start;flex-wrap:wrap;gap:10px;}
  .user-greeting{order:1;}
  .auth-link{order:2;}
  .cart-link{order:3;}
  .nav-cta{display:none;}
  .footer-top{grid-template-columns:1fr 1fr;gap:28px;}
  .footer-bottom{flex-direction:column;gap:16px;}
  .ai-fab{width:58px;height:58px;right:16px;bottom:16px;}
  .ai-core{width:58px;height:58px;}
  .ai-bubble{right:82px;bottom:26px;max-width:200px;}
  {% if is_rtl %}.ai-fab{left:16px;right:auto;}{% endif %}
  {% if is_rtl %}.ai-bubble{left:82px;right:auto;}{% endif %}
}
@media(max-width:600px){
  .lang-btn{padding:4px 8px;font-size:9px;}
  .auth-link,.cart-link,.user-greeting{font-size:9px;letter-spacing:.08em;}
  .user-greeting{display:none;}
  footer{padding:64px 20px 28px;}
  .footer-top{grid-template-columns:1fr;gap:22px;padding-bottom:36px;}
  .footer-copy{text-align:center;}
  .summer-card{padding:22px 14px 16px;}
  .summer-copy{font-size:12px;line-height:1.7;}
  .summer-actions{display:grid;grid-template-columns:1fr;}
  .summer-btn,.summer-skip{text-align:center;}
  .summer-skip{position:static;margin-top:10px;}
}
@media(hover:none),(pointer:coarse){
  body{cursor:auto;}
  .cursor,.cursor-ring{display:none;}
}
</style>
{% block extra_css %}{% endblock %}
</head>
<body>

<div class="cursor" id="cursor"></div>
<div class="cursor-ring" id="cursorRing"></div>

{% if messages %}
<div class="messages-container">
  {% for message in messages %}
  <div class="message">{{ message }}</div>
  {% endfor %}
</div>
{% endif %}

{% if request.user.is_authenticated or request.session.guest_allowed %}
<div class="summer-notice" id="summerNotice">
  <div class="summer-card" role="dialog" aria-modal="true" aria-label="Launch notice">
    <span class="summer-badge">üöß {% if lang == 'ar' %}ŸÇÿ±Ÿäÿ®ÿßŸã{% elif lang == 'fr' %}Bientot{% else %}Coming Soon{% endif %}</span>
    <h2 class="summer-title">{% if lang == 'ar' %}ŸÖÿ™ÿ¨ÿ±ŸÜÿß ŸäŸÅÿ™ÿ≠ ÿ±ÿ≥ŸÖŸäÿßŸã Ÿáÿ∞ÿß ÿßŸÑÿµŸäŸÅ!{% elif lang == 'fr' %}Notre boutique ouvre officiellement cet ete !{% else %}Our shop officially opens this summer!{% endif %}</h2>
    <p class="summer-copy">{% if lang == 'ar' %}ÿßÿ≠ÿµŸÑ ÿπŸÑŸâ ÿØÿÆŸàŸÑ ŸÖÿ®ŸÉÿ± ÿßŸÑÿ¢ŸÜ: ÿßÿ¥ÿ™ÿ±ŸÉ ÿßŸÑŸäŸàŸÖ Ÿàÿßÿ™ÿ±ŸÉ ŸÖÿ±ÿßÿ¨ÿπÿ© ŸÑÿ™ÿ≠ÿµŸÑ ÿπŸÑŸâ ÿÆÿµŸÖ 20% ÿπŸÜÿØ ÿßŸÑÿ•ÿ∑ŸÑÿßŸÇ.{% elif lang == 'fr' %}Obtenez un acces anticipe maintenant : inscrivez-vous aujourd'hui et laissez un avis pour recevoir 20% de reduction au lancement.{% else %}Get early access now‚Äîsign up today and leave a review to receive 20% off when we launch.{% endif %}</p>
    <div class="summer-actions">
      <a href="#newsletterBlock" class="summer-btn primary" data-close-summer>{% if lang == 'ar' %}ÿßŸÜÿ∂ŸÖ ÿßŸÑÿ¢ŸÜ{% elif lang == 'fr' %}S'inscrire{% else %}Get Early Access{% endif %}</a>
      <a href="{{ site.instagram_url }}" target="_blank" rel="noopener" class="summer-btn">{% if lang == 'ar' %}ÿßÿ™ÿ±ŸÉ ŸÖÿ±ÿßÿ¨ÿπÿ©{% elif lang == 'fr' %}Laisser un avis{% else %}Leave a Review{% endif %}</a>
      <button type="button" class="summer-skip" data-close-summer>{% if lang == 'ar' %}ÿ™ÿÆÿ∑Ÿä{% elif lang == 'fr' %}Passer{% else %}Skip{% endif %}</button>
    </div>
  </div>
</div>
{% endif %}

<!-- Nav -->
<nav>
  <a href="{% url 'home' %}" class="logo">MOON<span>BLOCK</span></a>
  <ul class="nav-links">
    <li><a href="{% url 'shop' %}" {% if request.resolver_match.url_name == 'shop' %}class="active"{% endif %}>{% site_t site 'nav_shop' lang %}</a></li>
    <li>
      <a href="{% url 'shop' %}?category=gym">{% site_t site 'nav_gym' lang %}</a>
      <div class="nav-dropdown">
        <a href="{% url 'shop' %}?category=gym" {% if request.GET.category == 'gym' and not request.GET.section %}class="active"{% endif %}>
          {% if lang == 'ar' %}ŸÉŸÑ ŸÖŸÜÿ™ÿ¨ÿßÿ™ ÿßŸÑÿ¨ŸäŸÖ{% elif lang == 'fr' %}Tout Gym{% else %}All Gym{% endif %}
        </a>
        {% for cat in all_categories %}
        {% if cat.slug == 'gym-wear' or cat.slug == 'accessories' %}
        <a href="{% url 'shop' %}?category={{ cat.slug }}" {% if request.GET.category == cat.slug %}class="active"{% endif %}>{{ cat.name|t:lang }}</a>
        {% endif %}
        {% endfor %}
      </div>
    </li>
    <li>
      <a href="{% url 'shop' %}?category=outerwear">{% site_t site 'nav_streetwear' lang %}</a>
      {% if outerwear_sections %}
      <div class="nav-dropdown">
        <a href="{% url 'shop' %}?category=outerwear" {% if request.GET.category == 'outerwear' and not request.GET.section %}class="active"{% endif %}>
          {% if lang == 'ar' %}ŸÉŸÑ ÿßŸÑŸÖŸÑÿßÿ®ÿ≥ ÿßŸÑÿÆÿßÿ±ÿ¨Ÿäÿ©{% elif lang == 'fr' %}Tout Outerwear{% else %}All Outerwear{% endif %}
        </a>
        {% for section in outerwear_sections %}
        <a href="{% url 'shop' %}?category=outerwear&section={{ section.slug }}" {% if request.GET.section == section.slug %}class="active"{% endif %}>{{ section.name|t:lang }}</a>
        {% endfor %}
      </div>
      {% endif %}
    </li>
    <li><a href="{% url 'lookbook' %}" {% if request.resolver_match.url_name == 'lookbook' %}class="active"{% endif %}>{% site_t site 'nav_lookbook' lang %}</a></li>
    <li><a href="{% url 'home' %}#about">{% site_t site 'nav_about' lang %}</a></li>
  </ul>
  <div class="nav-right">
    <!-- Language Switcher -->
    <div class="lang-switcher">
      <a href="{% url 'set_language' 'en' %}" class="lang-btn {% if lang == 'en' %}active{% endif %}">EN</a>
      <a href="{% url 'set_language' 'ar' %}" class="lang-btn {% if lang == 'ar' %}active{% endif %}">AR</a>
      <a href="{% url 'set_language' 'fr' %}" class="lang-btn {% if lang == 'fr' %}active{% endif %}">FR</a>
    </div>
    {% if request.user.is_authenticated %}
    <span class="user-greeting">{% if lang == 'ar' %}ŸÖÿ±ÿ≠ÿ®ÿßŸã {{ request.user.first_name|default:request.user.username }}{% elif lang == 'fr' %}Salut {{ request.user.first_name|default:request.user.username }}{% else %}Hey {{ request.user.first_name|default:request.user.username }}{% endif %}</span>
    <a href="{% url 'logout' %}" class="auth-link">{% if lang == 'ar' %}ÿÆÿ±Ÿàÿ¨{% elif lang == 'fr' %}Deconnexion{% else %}Logout{% endif %}</a>
    {% else %}
    <a href="{% url 'login' %}" class="auth-link">{% if lang == 'ar' %}ÿØÿÆŸàŸÑ{% elif lang == 'fr' %}Connexion{% else %}Login{% endif %}</a>
    <a href="{% url 'register' %}" class="auth-link">{% if lang == 'ar' %}ÿ™ÿ≥ÿ¨ŸäŸÑ{% elif lang == 'fr' %}Inscription{% else %}Register{% endif %}</a>
    {% endif %}
    <a href="{% url 'cart' %}" class="cart-link">
      {% if lang == 'ar' %}ÿ≠ŸÇŸäÿ®ÿ©{% elif lang == 'fr' %}Sac{% else %}Bag{% endif %}
      <span class="cart-badge" id="cartBadge" {% if not cart_count %}style="display:none"{% endif %}>{{ cart_count }}</span>
    </a>
    <a href="{% url 'shop' %}" class="nav-cta">{% site_t site 'nav_shopnow' lang %}</a>
  </div>
</nav>

{% block content %}{% endblock %}

<!-- Ticker -->
{% block ticker %}
<div class="ticker">
  <div class="ticker-inner">
    {% site_t site 'ticker_items' lang as ticker_raw %}
    {% with items=ticker_raw|split:',' %}
    {% for item in items %}<span class="ticker-item">{{ item }}</span><span class="ticker-dot">‚ú¶</span>{% endfor %}
    {% for item in items %}<span class="ticker-item">{{ item }}</span><span class="ticker-dot">‚ú¶</span>{% endfor %}
    {% endwith %}
  </div>
</div>
{% endblock %}

<!-- Newsletter -->
<div id="newsletterBlock" class="newsletter-block reveal" style="background:var(--moon);color:var(--black);text-align:center;padding:100px 48px;" {% if is_rtl %}dir="rtl"{% endif %}>
  <p style="font-size:11px;letter-spacing:.3em;text-transform:uppercase;color:rgba(6,6,8,.5);margin-bottom:12px;">{% site_t site 'newsletter_label' lang %}</p>
  <h2 style="font-family:'Bebas Neue';font-size:clamp(40px,6vw,72px);letter-spacing:.03em;color:var(--black);margin-bottom:16px;">{% site_t site 'newsletter_title' lang %}</h2>
  <p style="font-size:13px;letter-spacing:.08em;opacity:.6;margin-bottom:40px;">{% site_t site 'newsletter_sub' lang %}</p>
  <form method="post" action="{% url 'newsletter_subscribe' %}" class="newsletter-form" style="display:flex;max-width:480px;margin:0 auto;">
    {% csrf_token %}
    <input type="email" name="email" placeholder="your@email.com" required class="newsletter-input"
      style="flex:1;background:rgba(6,6,8,.12);border:1px solid rgba(6,6,8,.2);color:var(--black);font-family:'DM Mono',monospace;font-size:12px;letter-spacing:.1em;padding:16px 20px;outline:none;">
    <button type="submit" class="newsletter-btn" style="background:var(--black);color:var(--moon);border:none;padding:16px 32px;font-family:'DM Mono',monospace;font-size:11px;letter-spacing:.2em;text-transform:uppercase;cursor:none;transition:background .3s;">
      {% if lang == 'ar' %}ÿßÿ¥ÿ™ÿ±ŸÉ{% elif lang == 'fr' %}S'abonner{% else %}Subscribe{% endif %}
    </button>
  </form>
</div>

<!-- Footer -->
<footer {% if is_rtl %}dir="rtl"{% endif %}>
  <div class="footer-top">
    <div class="footer-brand">
      <a href="{% url 'home' %}" class="logo">MOON<span>BLOCK</span></a>
      <p class="footer-tagline">{% site_t site 'footer_tagline' lang %}</p>
      <div class="socials" style="margin-top:32px;">
        <a href="{{ site.instagram_url }}" class="social-link" aria-label="Instagram">
          <svg class="social-icon" viewBox="0 0 24 24" fill="none" aria-hidden="true">
            <rect x="3" y="3" width="18" height="18" rx="5" stroke="currentColor" stroke-width="1.8"/>
            <circle cx="12" cy="12" r="4.2" stroke="currentColor" stroke-width="1.8"/>
            <circle cx="17.6" cy="6.6" r="1.1" fill="currentColor"/>
          </svg>
        </a>
        <a href="{{ site.tiktok_url }}" class="social-link">TK</a>
        <a href="{{ site.twitter_url }}" class="social-link">X</a>
      </div>
    </div>
    <div class="footer-col">
      <h4>{% if lang == 'ar' %}ÿ™ÿ≥ŸàŸÇ{% elif lang == 'fr' %}Boutique{% else %}Shop{% endif %}</h4>
      <ul>
        <li><a href="{% url 'shop' %}">{% if lang == 'ar' %}ŸÉŸÑ ÿßŸÑŸÖŸÜÿ™ÿ¨ÿßÿ™{% elif lang == 'fr' %}Tous les Produits{% else %}All Products{% endif %}</a></li>
        {% for cat in all_categories %}
        <li><a href="{% url 'shop' %}?category={{ cat.slug }}">{{ cat.name_en }}</a></li>
        {% endfor %}
      </ul>
    </div>
    <div class="footer-col">
      <h4>{% if lang == 'ar' %}ÿßŸÑÿπŸÑÿßŸÖÿ©{% elif lang == 'fr' %}Marque{% else %}Brand{% endif %}</h4>
      <ul>
        <li><a href="{% url 'home' %}#about">{% site_t site 'nav_about' lang %}</a></li>
        <li><a href="{% url 'lookbook' %}">{% site_t site 'nav_lookbook' lang %}</a></li>
      </ul>
    </div>
    <div class="footer-col">
      <h4>{% if lang == 'ar' %}ÿØÿπŸÖ{% elif lang == 'fr' %}Support{% else %}Support{% endif %}</h4>
      <ul>
        <li><a href="{% url 'sizing_guide' %}?mode=sizing">{% if lang == 'ar' %}ÿØŸÑŸäŸÑ ÿßŸÑŸÖŸÇÿßÿ≥ÿßÿ™{% elif lang == 'fr' %}Guide des Tailles{% else %}Sizing Guide{% endif %}</a></li>
      </ul>
    </div>
  </div>
  <div class="footer-bottom">
    <p class="footer-copy">¬© 2026 Moonblock. {% if lang == 'ar' %}ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÇ ŸÖÿ≠ŸÅŸàÿ∏ÿ©.{% elif lang == 'fr' %}Tous droits r√©serv√©s.{% else %}All rights reserved.{% endif %}</p>
    <p class="footer-copy">Privacy ¬∑ Terms</p>
  </div>
</footer>
<a href="{% url 'sizing_guide' %}" class="ai-fab" aria-label="{% if lang == 'ar' %}ŸÖÿ≥ÿßÿπÿØ ÿßŸÑÿ∞ŸÉÿßÿ° ÿßŸÑÿßÿµÿ∑ŸÜÿßÿπŸä{% elif lang == 'fr' %}Assistant IA{% else %}AI Assistant{% endif %}">
  <span class="ai-core">
    <span class="ai-face">
      <span class="ai-eye left"></span>
      <span class="ai-eye right"></span>
      <span class="ai-mouth"></span>
    </span>
    <span class="ai-hand"></span>
    <span class="ai-orbit"><span class="ai-dot"></span></span>
  </span>
</a>
<div class="ai-bubble" id="aiBubble">{% if lang == 'ar' %}ÿ£ÿÆÿ®ÿ±ŸÜŸä ÿ•ÿ∞ÿß ŸÉŸÜÿ™ ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ£Ÿä ŸÖÿ≥ÿßÿπÿØÿ©.{% elif lang == 'fr' %}Dites-moi si vous avez besoin d'aide.{% else %}Let me know if you need assistance.{% endif %}</div>

<script>
// Cursor
const cursor=document.getElementById('cursor');
const ring=document.getElementById('cursorRing');
let mx=0,my=0,rx=0,ry=0;
document.addEventListener('mousemove',e=>{mx=e.clientX;my=e.clientY;cursor.style.left=mx+'px';cursor.style.top=my+'px';});
function animRing(){rx+=(mx-rx)*.12;ry+=(my-ry)*.12;ring.style.left=rx+'px';ring.style.top=ry+'px';requestAnimationFrame(animRing);}
animRing();
document.querySelectorAll('a,button,.product-card,.cat-item,.ai-fab').forEach(el=>{
  el.addEventListener('mouseenter',()=>{cursor.style.width='20px';cursor.style.height='20px';ring.style.width='56px';ring.style.height='56px';});
  el.addEventListener('mouseleave',()=>{cursor.style.width='12px';cursor.style.height='12px';ring.style.width='36px';ring.style.height='36px';});
});
// Reveal
const io=new IntersectionObserver(entries=>entries.forEach(e=>{if(e.isIntersecting){e.target.classList.add('visible');io.unobserve(e.target);}}),{threshold:.1});
document.querySelectorAll('.reveal').forEach(r=>io.observe(r));
// Messages auto-hide
setTimeout(()=>document.querySelectorAll('.message').forEach(m=>m.style.opacity='0'),4000);
// Cart badge
function updateCartBadge(count){const b=document.getElementById('cartBadge');if(b){b.textContent=count;b.style.display=count>0?'flex':'none';}}
// Newsletter mobile stack
if(window.matchMedia('(max-width:600px)').matches){
  const nblock=document.querySelector('.newsletter-block');
  const nform=document.querySelector('.newsletter-form');
  const ninput=document.querySelector('.newsletter-input');
  const nbtn=document.querySelector('.newsletter-btn');
  if(nblock){nblock.style.padding='72px 20px';}
  if(nform){nform.style.flexDirection='column';nform.style.gap='10px';nform.style.maxWidth='100%';}
  if(ninput){ninput.style.width='100%';}
  if(nbtn){nbtn.style.width='100%';}
}
// AI avatar prompt on hover + idle
const aiFab=document.querySelector('.ai-fab');
const aiBubble=document.getElementById('aiBubble');
let aiIdleTimer=null;
function showAiBubble(ms=2800){
  if(!aiBubble)return;
  aiBubble.classList.add('show');
  clearTimeout(aiBubble._hideTimer);
  aiBubble._hideTimer=setTimeout(()=>aiBubble.classList.remove('show'),ms);
}
function startAiIdleTimer(){
  clearTimeout(aiIdleTimer);
  aiIdleTimer=setTimeout(()=>{
    if(aiFab){aiFab.classList.add('idle');setTimeout(()=>aiFab.classList.remove('idle'),1200);}
    showAiBubble(3400);
  },7000);
}
if(aiFab){
  aiFab.addEventListener('mouseenter',()=>showAiBubble(2600));
  aiFab.addEventListener('focus',()=>showAiBubble(2600));
}
['mousemove','scroll','keydown','touchstart','click'].forEach(evt=>window.addEventListener(evt,startAiIdleTimer,{passive:true}));
startAiIdleTimer();
// Launch notice popup
const summerNotice=document.getElementById('summerNotice');
if(summerNotice){
  const key='mb_summer_notice_dismissed';
  const closeNotice=()=>{summerNotice.classList.remove('show');localStorage.setItem(key,'1');};
  if(!localStorage.getItem(key)){setTimeout(()=>summerNotice.classList.add('show'),420);}
  summerNotice.addEventListener('click',e=>{if(e.target===summerNotice)closeNotice();});
  summerNotice.querySelectorAll('[data-close-summer]').forEach(btn=>btn.addEventListener('click',closeNotice));
}
</script>
{% block extra_js %}{% endblock %}
</body>
</html>
